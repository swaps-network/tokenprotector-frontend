<div class="base-block-content">
  <div class="app-content-block">

    <div class="form-block_title__view-title mtb-20">Contract N{{ reqData.id }}</div>
    
    <!-- Main form -->
    <div class="container-contract container-contract__view">

      <div class="left-contract">
        <div class="form-container form-container_contract">

          <mat-tab-group dynamicHeight animationDuration="0ms" color="white" class="tp-tabs">
            <mat-tab label="Contract info">

              <div class="form-block form-block_contract">

                <div class="form-block_title__view">
                  <span></span>
                  <span class="form-block_title__view-status"
                        [ngClass]="'contract-state__' + states[reqData.state].NUMBER">
                    {{ states[reqData.state].TEXT }}</span>
                </div>

                <label class="form-field_label fw-b">Contract address</label>
                <div class="form-field">
                  <div class="form-field_input width-100">
                    <input type="text"
                            class="min-text max-placeholder"
                            maxlength="42"
                            pattern="0x[0-9a-fA-F]{40}"
                            disabled
                            [(ngModel)]="reqData.contract_details.eth_contract.address"
                            placeholder="Ethereum address"
                            name="check_owner_address_1">
                            
                    <button type="button" class="copy-btn copy-btn__pa" ngxClipboard [cbContent]="reqData.contract_details.eth_contract.address">
                      <img src="./assets/images/icons/copy.svg"/>
                    </button>
                  </div>
                </div>

                <label class="form-field_label fw-b">Protected address</label>
                <div class="form-field">
                  <div class="form-field_input width-100">
                    <input type="text"
                      class="min-text max-placeholder width-100"
                      maxlength="42"
                      pattern="0x[0-9a-fA-F]{40}"
                      disabled
                      [(ngModel)]="reqData.contract_details.owner_address"
                      placeholder="Ethereum address"
                      name="check_reverse_address_2">

                      <button type="button" class="copy-btn copy-btn__pa" ngxClipboard [cbContent]="reqData.contract_details.owner_address">
                        <img src="./assets/images/icons/copy.svg"/>
                      </button>
                  </div>
                </div>
                
                <label class="form-field_label fw-b">Reserve address</label>
                <div class="form-field">
                  <div class="form-field_input width-100">
                    <input type="text"
                      class="min-text max-placeholder width-100"
                      maxlength="42"
                      pattern="0x[0-9a-fA-F]{40}"
                      disabled
                      [(ngModel)]="reqData.contract_details.reserve_address"
                      placeholder="Ethereum address"
                      name="check_reverse_address_2">

                      <button type="button" class="copy-btn copy-btn__pa" ngxClipboard [cbContent]="reqData.contract_details.reserve_address"> 
                        <img src="./assets/images/icons/copy.svg"/>
                      </button>
                  </div>
                </div>

                <label class="form-field_label fw-b">Protected tokens</label>
                <div class="form-field__tokens-view">
                  <div class="form-field__tokens-view_item" *ngFor="let token of tokensData.tokens | FilterTokens : false : false : '' : true">
                    <span class="form-field__tokens-view_item-title">
                      <span
                          class="form-field__tokens-view_item-image"
                          [ngStyle]="{'background-image':'url(' + token.image_link + ')'}">
                      </span>
                        {{ token.token_short_name }}
                    </span>
                  </div>
                </div>
        
                <div class="form-field_info-view">
                  <div class="form-field_info-view_row">
                    <div class="form-field_info-view_column">
                      <span class="form-field_info-view_column-title">Created date</span>
                      <span class="form-field_info-view_column-date">{{ reqData.created_date|date }}</span>
                    </div>
                    <div class="form-field_info-view_column">
                      <span class="form-field_info-view_column-title">Execution date</span>
                      <span class="form-field_info-view_column-date">{{ curDate|date }}</span>
                    </div>
                    <div class="form-field_info-view_column">
                      <span class="form-field_info-view_column-title">Notification e-mail</span>
                      <div class="form-field_info-view_column-mail">
                        <span class="form-field_info-view_column-mail_title">{{ reqData.contract_details.email || 'none' }}</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="form-field_line-view"></div>

                <div class="form-field_view-button">
                  <span class="button button-tp button-tp-blue is-large" [routerLink]="['/contracts']" routerLinkActive="router-link-active"><span class="caption">Back</span></span>
                  <span class="button button-tp button-tp-gray_light is-large" *ngIf="['ACTIVE'].includes(reqData.state)" (click)="cancelContract(reqData.contract_details.eth_contract);"><span class="caption" >Cancel contract</span></span>
                </div>

              </div>

            </mat-tab>

            <mat-tab *ngIf="['ACTIVE','DONE'].includes(reqData.state)" label="Source code">
              <div class="form-block form-block_contract pb-30">

                <div class="form-field_source-text">
                  <span class="form-field_source-text_title">Download:</span>
                  <span class="form-field_source-text_title">Contract <a (click)="saveContractSourceCode();" >source code</a></span>
                  <span class="form-field_source-text_title">Contract <a href="https://github.com/MyWishPlatform/token_saver" target="_blank">LibraLibraries & other files</a></span>
                </div>

                <div class="form-field_line-view"></div>

                <div class="form-field_source-text">
                  <span class="form-field_source-text_title">To verify contract source code by Etherscan please contact us by email or follow the instruction:</span>
                </div>

                <div class="form-field_source-text form-field_source-steps" data-step="1">
                  <span class="form-field_source-text_title">Open contract address on <a [attr.href]="'https://ropsten.etherscan.io/address/'+reqData.contract_details.eth_contract.address+'#code'" target="_blank">etherscan</a></span>
                </div>

                <div class="form-field_source-text form-field_source-steps" data-step="2">
                  <span class="form-field_source-text_title">In Contract Code tab choose "Verify And Publish"</span>
                </div>

                <div class="form-field_source-text form-field_source-steps" data-step="3">
                  <div class="form-field">
                    <label class="form-field_label fw-b">Enter Contract Name:</label>
                    <div class="form-field_input width-100">
                      <input type="text"
                        class="min-text max-placeholder width-100"
                        maxlength="42"
                        pattern="0x[0-9a-fA-F]{40}"
                        disabled
                        [(ngModel)]="reqData.name"
                        placeholder="Ethereum address"
                        name="contract_name">

                        <button type="button" class="copy-btn copy-btn__pa" ngxClipboard [cbContent]="reqData.name">
                          <img src="./assets/images/icons/copy.svg"/>
                        </button>
                    </div>
                  </div>
                </div>

                <div class="form-field_source-text form-field_source-steps" data-step="4">
                  <div class="form-field">
                    <label class="form-field_label fw-b">Enter Contract Address:</label>
                    <div class="form-field_input width-100">
                      <input type="text"
                        class="min-text max-placeholder width-100"
                        maxlength="42"
                        pattern="0x[0-9a-fA-F]{40}"
                        disabled
                        [(ngModel)]="reqData.contract_details.eth_contract.address"
                        placeholder="Ethereum address"
                        name="contract_address">

                        <button type="button" class="copy-btn copy-btn__pa" ngxClipboard [cbContent]="reqData.contract_details.eth_contract.address">
                          <img src="./assets/images/icons/copy.svg"/>
                        </button>
                    </div>
                  </div>
                </div>

                <div class="form-field_source-text form-field_source-steps" data-step="5">
                  <div class="form-field">
                    <label class="form-field_label fw-b">Fill out Compiler version:</label>
                    <div class="form-field_input width-100">
                      <input type="text"
                        class="min-text max-placeholder width-100"
                        disabled
                        [(ngModel)]="reqData.contract_details.eth_contract.compiler_version"
                        placeholder="Compiler version"
                        name="contract_compiler_version">

                        <button type="button" class="copy-btn copy-btn__pa" ngxClipboard [cbContent]="reqData.contract_details.eth_contract.compiler_version">
                          <img src="./assets/images/icons/copy.svg"/>
                        </button>
                    </div>
                  </div>
                </div>

                <div class="form-field_source-text form-field_source-steps" data-step="6">
                  <div class="form-field">
                    <label class="form-field_label fw-b">Paste the Solidity Contract code:</label>
                    <div class="form-field_input width-100">
                      <textarea type="text"
                        class="min-text max-placeholder width-100"
                        maxlength="42"
                        pattern="0x[0-9a-fA-F]{40}"
                        disabled
                        [(ngModel)]="reqData.contract_details.eth_contract.source_code"
                        placeholder="Solidity Contract code"
                        name="contract_source_code"></textarea>

                        <button type="button" class="copy-btn copy-btn__pa" ngxClipboard [cbContent]="reqData.contract_details.eth_contract.source_code">
                          <img src="./assets/images/icons/copy.svg"/>
                        </button>
                    </div>
                  </div>
                </div>

                <div class="form-field_source-text form-field_source-steps" data-step="7">
                  <span class="form-field_source-text_title">Remove the parameters from the Constructor argument field ABI-encoded</span>
                </div>

                <div class="form-field_source-text form-field_source-steps" data-step="8">
                  <span class="form-field_source-text_title">Others fields are not required. Press «Verify And Publish»</span>
                </div>

              </div>
            </mat-tab>


          </mat-tab-group> 

        </div>
      </div>

      <div class="right-contract-view">
        <div class="d-flex fd-column">
          <!-- <span class="button button-tp button-tp-watch is-medium">
            <span class="caption">Watch instruction</span>
          </span>
          <span class="button button-tp button-tp-support button-tp-icon-support is-medium">
            <span class="caption">Support</span>
          </span> -->
        </div>
      </div>

    </div>
  </div>

</div>